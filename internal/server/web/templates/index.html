<!DOCTYPE html>
<html lang="en">
<head>
    <title>{{ .Data.Title }}</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="csrf-token" content="{{ .CSRFToken }}">
    
    <!-- Primary Meta Tags -->
    <meta name="title" content="{{ .Data.Title }}">
    <meta name="description" content="{{ index .Data.Settings "meta_description" }}">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ .Data.HeaderLinkURL }}">
    <meta property="og:title" content="{{ .Data.Title }}">
    <meta property="og:description" content="{{ index .Data.Settings "meta_description" }}">
    {{ if index .Data.Settings "meta_image_url" }}
    <meta property="og:image" content="{{ .Data.SiteURL }}/static/images/{{ index .Data.Settings "meta_image_url" }}">
    {{ end }}

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="{{ .Data.HeaderLinkURL }}">
    <meta property="twitter:title" content="{{ .Data.Title }}">
    <meta property="twitter:description" content="{{ index .Data.Settings "meta_description" }}">
    {{ if index .Data.Settings "meta_image_url" }}
    <meta name="twitter:image" content="{{ .Data.SiteURL }}/static/images/{{ index .Data.Settings "meta_image_url" }}">
    {{ end }}

    <link rel="icon" type="image/x-icon" href="/static/images/{{ index .Data.Settings "favicon_url" }}">
    <link rel="alternate" type="application/rss+xml" title="{{ .Data.Title }} Feed" href="/rss.xml" />
    
    <!-- External CSS -->
    <link rel="stylesheet" href="{{ themeCSS .Data.Settings "variables.css" }}">
    <link rel="stylesheet" href="/static/css/base.css">
    <link rel="stylesheet" href="{{ themeCSS .Data.Settings "public.css" }}">
    <link rel="stylesheet" href="{{ themeCSS .Data.Settings "ux-enhancements.css" }}">
    
    <!-- Preload critical favicons for faster loading -->
    {{ range $index, $entry := .Data.Entries }}
        {{ if lt $index 25 }}
    <link rel="preload" as="image" href="{{ $entry.FaviconURL }}">
        {{ end }}
    {{ end }}
    
    <style>
        /* Template-specific footer image height (Go template variable) */
        .footer-image img {
            height: {{ .Data.FooterImageHeight }};
        }
    </style>
</head>
<body>
    <h1>{{ .Data.Title }}</h1>
    <a href="{{ .Data.HeaderLinkURL }}" class="header-link return">{{ .Data.HeaderLinkText }}</a>

    <div class="feed">
        {{ range .Data.Entries }}        <div class="entry">
            
            <img class="favicon" data-src="{{ .FaviconURL }}" onerror="this.src='/static/favicons/default.ico'; this.onerror=null;" alt="">
            <div class="link-container">
                <a href="{{ .URL }}" data-entry-id="{{ .ID }}" target="_blank" rel="noopener noreferrer" class="tracked-link">
                    {{ if and .FeedTitle (eq (index $.Data.Settings "show_blog_name") "true") }}{{ .FeedTitle | html }}: {{ end }}{{ .Title | html }}
                </a>
                {{ if and .BodyText (eq (index $.Data.Settings "show_body_text") "true") }}
                <div class="body-text">{{ .BodyText | html }}</div>
                {{ end }}
            </div>
            <span class="dots">............................................................................................................................</span>
            <span class="date">{{ .Date }}</span>
        </div>
        {{ else }}
        <!-- Show when no entries -->
        <div class="no-entries">No entries found</div>
        {{ end }}
    </div>

    <div class="footer">
        {{ if .Data.FooterImageURL }}
        <div class="footer-image">
            <img src="/static/images/{{ .Data.FooterImageURL }}" alt="Footer image">
        </div>
        {{ end }}
        <a href="{{ .Data.FooterLinkURL }}" class="footer-link return">{{ .Data.FooterLinkText }}</a>
    </div>    <!-- External JavaScript -->
    <script type="module" src="/static/js/main.js"></script>
    
    <!-- Immediate favicon loading after page load -->
    

    {{ if .Data.TrackingCode }}
    {{ .Data.TrackingCode | safeHTML }}
    {{ end }}
</body>
</html>
